CREATE TABLE IF NOT EXISTS `platecode` (
  `id` mediumint(8) unsigned NOT NULL AUTO_INCREMENT,
  `p1` char(10) NOT NULL DEFAULT '_',
  `p2` char(2) NOT NULL DEFAULT '__',
  `p3` char(2) NOT NULL DEFAULT '__',
  `p4` char(2) NOT NULL DEFAULT '__',
  `p5` char(2) NOT NULL DEFAULT '__',
  `p6` char(2) NOT NULL DEFAULT '__',
  `p7` char(2) NOT NULL DEFAULT '__',
  `p8` char(2) NOT NULL DEFAULT '__',
  PRIMARY KEY (`id`),
  UNIQUE KEY `index_p1` (`p1`) USING BTREE,
  KEY `ip2` (`p2`) USING BTREE,
  KEY `ip3` (`p3`) USING BTREE,
  KEY `ip4` (`p4`) USING BTREE,
  KEY `ip5` (`p5`) USING BTREE,
  KEY `ip6` (`p6`) USING BTREE,
  KEY `ip7` (`p7`) USING BTREE,
  KEY `ip8` (`p8`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=gbk;


CREATE TABLE IF NOT EXISTS `traffic`(
  `id` int(20) unsigned NOT NULL AUTO_INCREMENT,
  `passtime` date NOT NULL DEFAULT '2010-01-01',
  `platecode_id` mediumint(8) unsigned NOT NULL DEFAULT '1',
  PRIMARY KEY (`id`,`passtime`),
  UNIQUE KEY `index_passtime` (`passtime`,`platecode_id`) USING BTREE,
  KEY `index_p_id` (`platecode_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=gbk
PARTITION BY RANGE (to_days(passtime))
(
 PARTITION p201401 VALUES LESS THAN (to_days('2014-02-01')) ENGINE = InnoDB,
 PARTITION p201402 VALUES LESS THAN (to_days('2014-03-01')) ENGINE = InnoDB,
 PARTITION p201403 VALUES LESS THAN (to_days('2014-04-01')) ENGINE = InnoDB,
 PARTITION p201404 VALUES LESS THAN (to_days('2014-05-01')) ENGINE = InnoDB,
 PARTITION p201405 VALUES LESS THAN (to_days('2014-06-01')) ENGINE = InnoDB,
 PARTITION p201406 VALUES LESS THAN (to_days('2014-07-01')) ENGINE = InnoDB,
 PARTITION p201407 VALUES LESS THAN (to_days('2014-08-01')) ENGINE = InnoDB,
 PARTITION p201408 VALUES LESS THAN (to_days('2014-09-01')) ENGINE = InnoDB,
 PARTITION p201409 VALUES LESS THAN (to_days('2014-10-01')) ENGINE = InnoDB,
 PARTITION p201410 VALUES LESS THAN (to_days('2014-11-01')) ENGINE = InnoDB,
 PARTITION p201411 VALUES LESS THAN (to_days('2014-12-01')) ENGINE = InnoDB,
 PARTITION p201412 VALUES LESS THAN (to_days('2015-01-01')) ENGINE = InnoDB,
 PARTITION p201501 VALUES LESS THAN (to_days('2015-02-01')) ENGINE = InnoDB,
 PARTITION p201502 VALUES LESS THAN (to_days('2015-03-01')) ENGINE = InnoDB,
 PARTITION p201503 VALUES LESS THAN (to_days('2015-04-01')) ENGINE = InnoDB,
 PARTITION p201504 VALUES LESS THAN (to_days('2015-05-01')) ENGINE = InnoDB,
 PARTITION p201505 VALUES LESS THAN (to_days('2015-06-01')) ENGINE = InnoDB,
 PARTITION p201506 VALUES LESS THAN (to_days('2015-07-01')) ENGINE = InnoDB,
 PARTITION p201507 VALUES LESS THAN (to_days('2015-08-01')) ENGINE = InnoDB,
 PARTITION p201508 VALUES LESS THAN (to_days('2015-09-01')) ENGINE = InnoDB,
 PARTITION p201509 VALUES LESS THAN (to_days('2015-10-01')) ENGINE = InnoDB,
 PARTITION p201510 VALUES LESS THAN (to_days('2015-11-01')) ENGINE = InnoDB,
 PARTITION p201511 VALUES LESS THAN (to_days('2015-12-01')) ENGINE = InnoDB,
 PARTITION p201512 VALUES LESS THAN (to_days('2016-01-01')) ENGINE = InnoDB,
 PARTITION pMAX VALUES LESS THAN MAXVALUE ENGINE = InnoDB);

/* 增加traffic表分区，范围2013 */
ALTER TABLE traffic REORGANIZE PARTITION p201401 INTO(
PARTITION p201301 VALUES LESS THAN (to_days('2013-02-01')),
 PARTITION p201302 VALUES LESS THAN (to_days('2013-03-01')),
 PARTITION p201303 VALUES LESS THAN (to_days('2013-04-01')),
 PARTITION p201304 VALUES LESS THAN (to_days('2013-05-01')),
 PARTITION p201305 VALUES LESS THAN (to_days('2013-06-01')),
 PARTITION p201306 VALUES LESS THAN (to_days('2013-07-01')),
 PARTITION p201307 VALUES LESS THAN (to_days('2013-08-01')),
 PARTITION p201308 VALUES LESS THAN (to_days('2013-09-01')),
 PARTITION p201309 VALUES LESS THAN (to_days('2013-10-01')),
 PARTITION p201310 VALUES LESS THAN (to_days('2013-11-01')),
 PARTITION p201311 VALUES LESS THAN (to_days('2013-12-01')),
 PARTITION p201312 VALUES LESS THAN (to_days('2014-01-01')),
 PARTITION p201401 VALUES LESS THAN (to_days('2014-02-01'))
);